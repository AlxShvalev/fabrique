# Сервис рассылки

Тестовое задание на позицию python-разработчик в Фабрику решений

## Описание
Сервис представляет собой API для  создания рассылок, а так же управления ими и 
получения статистики по выполненным рассылкам.

Для осуществления рассылок в сервисе предусмотрены следующие сущности:

### Client
Клиент для рассылки. Содержит аттрибуты:
- id
- номер телефона
- код оператора
- часовой пояс
- тег

### Mailing
Объект рассылки. Содержит аттрибуты:
- id
- дата и время начала рассылки
- дата и время окончания рассылки
- текст сообщения
- фильтр клиентов для рассылки

### Message
Объект сообщения. Содержит аттрибуты:
- id
- id рассылки
- id клиента
- статус отправки
- дата и время отправки

## Логика рассылки
- После создания новой рассылки, если текущее время больше времени начала и меньше времени окончания - должны быть выбраны из справочника все клиенты, которые подходят под значения фильтра, указанного в этой рассылке и запущена отправка для всех этих клиентов.
- Если создаётся рассылка с временем старта в будущем - отправка должна стартовать автоматически по наступлению этого времени без дополнительных действий со стороны пользователя системы.
- По ходу отправки сообщений должна собираться статистика (см. описание сущности "сообщение" выше) по каждому сообщению для последующего формирования отчётов.
- Внешний сервис, который принимает отправляемые сообщения, может долго обрабатывать запрос, отвечать некорректными данными, на какое-то время вообще не принимать запросы. Необходимо реализовать корректную обработку подобных ошибок. Проблемы с внешним сервисом не должны влиять на стабильность работы разрабатываемого сервиса рассылок.

## Документация по API
Документация по использованию API доступна после запуска по адресу `http://host.domain/docs` 

## Запуск проекта
Для запуска проекта клонируйте репозиторий
```bash
git clone git@github.com:AlxShvalev/fabrique.git
```

Перейдите в директорию с сервисом
`cd fabrique/`

Переименуйте файл `.env_example` в `.env` и заполните его корректными переменными окружения

Перейдите в директорию infra `cd infra/` и выполните там команду
```bash
sudo docker-compose up -d --build
```
После запуска контейнеров необходимо создать суперпользователя django
```bash
sudo docker-compose exec backend python manage.py createsuperuser
```
следуйте указаниям по созданию пользователя.

## Выполненные дополнительные задания
- подготовить docker-compose для запуска всех сервисов проекта одной командой
-  по адресу /docs/ открывалась страница со Swagger UI и в нём 
отображалось описание разработанного API.

### Автор
Швалев Алексей
